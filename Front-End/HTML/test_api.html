<!DOCTYPE html>
<html>
<head>
    <title>Test Dashboard Stats API</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .result { background: #f0f0f0; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .error { background: #ffebee; color: #c62828; }
        .success { background: #e8f5e9; color: #2e7d32; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; }
        pre { background: #fff; padding: 10px; border: 1px solid #ddd; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Dashboard Stats API Test</h1>
    
    <div>
        <label>Student ID: <input type="number" id="studentId" value="1"></label>
        <button onclick="testAPI()">Test API</button>
    </div>
    
    <div id="result"></div>
    
    <script>
        function testAPI() {
            const studentId = document.getElementById('studentId').value;
            const resultDiv = document.getElementById('result');
            
            resultDiv.innerHTML = '<div class="result">Loading...</div>';
            
            fetch(`/students/${studentId}/dashboard/stats`)
                .then(res => {
                    console.log('Response status:', res.status);
                    console.log('Response headers:', res.headers);
                    
                    if (!res.ok) {
                        return res.text().then(text => {
                            throw new Error(`HTTP ${res.status}: ${text}`);
                        });
                    }
                    return res.json();
                })
                .then(data => {
                    console.log('Success! Data:', data);
                    resultDiv.innerHTML = `
                        <div class="result success">
                            <h3>✓ Success!</h3>
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>
                    `;
                })
                .catch(err => {
                    console.error('Error:', err);
                    resultDiv.innerHTML = `
                        <div class="result error">
                            <h3>✗ Error</h3>
                            <p>${err.message}</p>
                        </div>
                    `;
                });
        }
        
        // Auto-test on load
        window.addEventListener('DOMContentLoaded', () => {
            console.log('Page loaded, testing API...');
            testAPI();
        });
    </script>
</body>
</html>
